(function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c){this.apiKey=a,this.apiUrl=c,this.authorizeAjax=b(this.authorizeAjax,this),this.initializeContentBlocks(function(a){return function(){return $("a.edit").click(function(){var b=this;return a.getContentBlockForEdit($(b).parent().parent().attr("data-block"),function(){return $("a.save").click(function(){var b,c,d=this;return c=$(d).parent().parent().find("textarea").val(),b=$(d).parent().parent().attr("data-block"),a.updateContentBlock(b,c)})})})}}(this))}return a.prototype.getApiKey=function(){return"Token token="+this.apiKey},a.prototype.getApiUrl=function(){return this.apiUrl},a.prototype.initializeContentBlocks=function(a){return $.ajax({type:"GET",url:this.getApiUrl()+"content_blocks.json",beforeSend:this.authorizeAjax,dataType:"json",success:function(b){return function(c){return $.each(c,function(c,d){return b.drawContentBlock(d),a()})}}(this)})},a.prototype.getEmptyContentBlockHolder=function(a){return $("div[data-block='"+a+"']").empty().addClass("content-block")},a.prototype.drawContentBlock=function(a){var b;return b=this.getEmptyContentBlockHolder(a.id),b.length>0?(b.append($("<div>").addClass("toolbar").append($("<a>").addClass("edit").text("edit"))),b.append($("<div>").addClass("content").html(a.content))):void 0},a.prototype.getContentBlockForEdit=function(a,b){return $.ajax({type:"GET",url:this.getApiUrl()+"content_blocks/"+a+".json",beforeSend:this.authorizeAjax,dataType:"json",success:function(a){return function(c){return a.makeContentBlockEditable(c,b)}}(this)})},a.prototype.makeContentBlockEditable=function(a,b){var c;return c=this.getEmptyContentBlockHolder(a.id),c.length>0?(c.append($("<div>").addClass("toolbar").append($("<a>").addClass("save").text("save"))),c.append($("<textarea>").attr("id","block_"+a.id).html(a.content)),b()):void 0},a.prototype.createContentBlock=function(a,b){return $.ajax({type:"POST",url:this.getApiUrl()+"content_blocks.json",beforeSend:this.authorizeAjax,data:{content_block:{content_path:a,content:b}},dataType:"json"})},a.prototype.updateContentBlock=function(a,b){return $.ajax({type:"PUT",url:this.getApiUrl()+"content_blocks/"+a+".json",beforeSend:this.authorizeAjax,data:{content_block:{content:b}},dataType:"json",success:function(a){return location.reload()}})},a.prototype.deleteContentBlock=function(a){return $.ajax({type:"DELETE",url:this.getApiUrl()+"content_blocks/"+a+".json",beforeSend:this.authorizeAjax,dataType:"json"})},a.prototype.authorizeAjax=function(a){return a.setRequestHeader("Authorization",this.getApiKey())},a}(),window.renuoCmsClient=a}).call(this);